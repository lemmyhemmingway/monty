<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monty Dashboard</title>
    <link rel="stylesheet" href="/static/css/dashboard.css">
</head>
<body>
    <h1>Monty Health Monitoring Dashboard</h1>

    <!-- Tabs -->
    <div class="tabs">
        <button class="tab-button active" onclick="showTab('all')">All</button>
        <button class="tab-button" onclick="showTab('http')">HTTP</button>
        <button class="tab-button" onclick="showTab('ssl')">SSL</button>
        <button class="tab-button" onclick="showTab('dns')">DNS</button>
        <button class="tab-button" onclick="showTab('domain')">Domain</button>
        <button class="tab-button" onclick="showTab('ping')">Ping</button>
        <button class="tab-button" onclick="showTab('tcp')">TCP</button>
    </div>

    <h2>Add New Endpoint</h2>
    <form id="endpoint-form">
        <label>URL: <input type="text" name="url" required></label><br>
        <label>Check Type:
            <input type="radio" name="check_type" value="http" checked> HTTP
            <input type="radio" name="check_type" value="ssl" class="check-type"> SSL
            <input type="radio" name="check_type" value="dns" class="check-type"> DNS
            <input type="radio" name="check_type" value="domain" class="check-type"> Domain
            <input type="radio" name="check_type" value="ping" class="check-type"> Ping
            <input type="radio" name="check_type" value="tcp" class="check-type"> TCP
        </label><br>
        <label>Interval (seconds): <input type="number" name="interval" value="60" required></label><br>
        <label>Timeout (seconds): <input type="number" name="timeout" value="30"></label><br>

        <div class="http-fields">
            <label>Expected Status Codes (comma separated): <input type="text" name="expected_status_codes" value="200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,307,308"></label><br>
            <label>Max Response Time (ms): <input type="number" name="max_response_time" value="5000"></label><br>
        </div>

        <div class="ssl-fields">
        <label>Min Days Valid: <input type="number" name="min_days_valid" value="30"></label><br>
        <label>Check Chain: <input type="checkbox" name="check_chain" checked></label><br>
        <label>Check Domain Match: <input type="checkbox" name="check_domain_match" checked></label><br>
        <label>Acceptable TLS Versions (comma separated): <input type="text" name="acceptable_tls_versions" value="TLS 1.2,TLS 1.3"></label><br>
        </div>

        <div class="dns-fields">
            <label>DNS Record Type: <select name="dns_record_type">
                <option value="A">A</option>
                <option value="AAAA">AAAA</option>
                <option value="CNAME">CNAME</option>
                <option value="MX">MX</option>
                <option value="TXT">TXT</option>
            </select></label><br>
            <label>Expected DNS Answers (minimum): <input type="number" name="expected_dns_answers" value="1"></label><br>
        </div>

        <div class="tcp-fields">
            <label>TCP Port: <input type="number" name="tcp_port" value="80"></label><br>
        </div>

        <button type="submit">Add Endpoint</button>
    </form>

    <!-- All Endpoints Table -->
    <div id="all" class="tab-content">
        <h2>All Endpoints</h2>
        <table>
            <thead>
                <tr>
                    <th>#</th>
                    <th>URL</th>
                    <th>Type</th>
                    <th>Interval</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {{$counter := 1}}
                {{range $type, $eps := .groupedEndpoints}}
                {{range $eps}}
                <tr>
                    <td>{{$counter}}</td>
                    <td>{{.URL}}</td>
                    <td>{{$type}}</td>
                    <td>{{.Interval}}s</td>
                    <td class="status {{if eq .StatusString "Valid"}}valid{{else if eq .StatusString "Invalid"}}invalid{{else if or (contains .StatusString "days") (contains .StatusString "%")}}uptime{{else}}unknown{{end}}">
                        {{.StatusString}}
                    </td>
                    <td>
                    {{if eq $type "http"}}
                    <a href="/endpoints/{{.ID}}/statuses">Statuses</a>
                    {{else if eq $type "ssl"}}
                    <a href="/endpoints/{{.ID}}/ssl-statuses">SSL Statuses</a>
                    {{else if eq $type "domain"}}
                    <a href="/endpoints/{{.ID}}/domain-statuses">Domain Statuses</a>
                    {{else}}
                        <a href="/endpoints/{{.ID}}/statuses">Statuses</a>
                         {{end}}
                         <button onclick="deleteEndpoint('{{.ID}}')" style="margin-left: 10px; color: red;">Delete</button>
                     </td>
                </tr>
                {{$counter = inc $counter}}
                {{end}}
                {{end}}
            </tbody>
        </table>
    </div>

    <!-- HTTP Endpoints Table -->
    <div id="http" class="tab-content" style="display: none;">
        <h2>HTTP Endpoints</h2>
        <table>
            <thead>
                <tr>
                    <th>#</th>
                    <th>URL</th>
                    <th>Interval</th>
                    <th>Uptime</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {{range $i, $ep := index .groupedEndpoints "http"}}
                <tr>
                    <td>{{$i | add 1}}</td>
                    <td>{{$ep.URL}}</td>
                    <td>{{$ep.Interval}}s</td>
                    <td class="status uptime">{{$ep.StatusString}}</td>
                    <td>
                        <a href="/endpoints/{{$ep.ID}}/statuses">Statuses</a>
                        <button onclick="deleteEndpoint('{{$ep.ID}}')" style="margin-left: 10px; color: red;">Delete</button>
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>

    <!-- SSL Endpoints Table -->
    <div id="ssl" class="tab-content" style="display: none;">
        <h2>SSL Endpoints</h2>
        <table>
            <thead>
                <tr>
                    <th>#</th>
                    <th>URL</th>
                    <th>Interval</th>
                    <th>SSL Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {{range $i, $ep := index .groupedEndpoints "ssl"}}
                <tr>
                    <td>{{$i | add 1}}</td>
                    <td>{{$ep.URL}}</td>
                    <td>{{$ep.Interval}}s</td>
                    <td class="status {{if eq $ep.StatusString "Valid"}}valid{{else}}invalid{{end}}">{{$ep.StatusString}}</td>
                    <td>
                        <a href="/endpoints/{{$ep.ID}}/ssl-statuses">SSL Statuses</a>
                        <button onclick="deleteEndpoint('{{$ep.ID}}')" style="margin-left: 10px; color: red;">Delete</button>
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>

    <!-- Domain Endpoints Table -->
    <div id="domain" class="tab-content" style="display: none;">
        <h2>Domain Endpoints</h2>
        <table>
            <thead>
                <tr>
                    <th>#</th>
                    <th>Domain</th>
                    <th>Interval</th>
                    <th>Days Left</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {{range $i, $ep := index .groupedEndpoints "domain"}}
                <tr>
                    <td>{{$i | add 1}}</td>
                    <td>{{$ep.URL}}</td>
                    <td>{{$ep.Interval}}s</td>
                    <td class="status uptime">{{$ep.StatusString}}</td>
                    <td>
                        <a href="/endpoints/{{$ep.ID}}/domain-statuses">Domain Statuses</a>
                        <button onclick="deleteEndpoint('{{$ep.ID}}')" style="margin-left: 10px; color: red;">Delete</button>
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>

    <!-- Other types can be added similarly -->

    <script src="/static/js/dashboard.js"></script>
</body>
</html>
